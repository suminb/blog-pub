<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <title>메모리 할당</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="description" content=""/>

    <meta property="og:type" content="artitle"/>
    <meta property="og:url" content="http://philosophical.one/posts/memory-allocation/"/>
    <meta property="og:title" content="메모리 할당"/>
    <meta property="og:description" content=""/>
    <meta property="og:image" content="http://philosophical.one"/>
    <meta property="og:image_source" content=""/>

    <link rel="canonical" href="http://philosophical.one/posts/memory-allocation/"/>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/main.css"/>

</head>


    <body>

    <header class="site-header">

  <div class="wrap">
    <a class="site-title" href="/">Rubbish Philosopher</a>
    <!--
    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
          <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
            h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
            h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
            c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">
        
          <a class="page-link" href="/feed.xml"></a>
        
          <a class="page-link" href="/"></a>
        
          <a class="page-link" href="/archives/57/"></a>
        
          <a class="page-link" href="/post/memory-allocation"></a>
        
          <a class="page-link" href="/archives/4/"></a>
        
          <a class="page-link" href="/post/the-devil-code"></a>
        
          <a class="page-link" href="/archives/71/"></a>
        
          <a class="page-link" href="/post/jsp-custom-tag"></a>
        
          <a class="page-link" href="/archives/136/"></a>
        
          <a class="page-link" href="/post/object-serialization"></a>
        
          <a class="page-link" href="/archives/300/"></a>
        
          <a class="page-link" href="/post/convert-from-javautildate-to-javasqldate"></a>
        
          <a class="page-link" href="/archives/301/"></a>
        
          <a class="page-link" href="/post/javabeans"></a>
        
          <a class="page-link" href="/archives/303/"></a>
        
          <a class="page-link" href="/post/java-socket-programming-basics"></a>
        
          <a class="page-link" href="/archives/306/"></a>
        
          <a class="page-link" href="/post/thoughts-about-iterator-pattern"></a>
        
          <a class="page-link" href="/archives/310/"></a>
        
          <a class="page-link" href="/post/exccesive-constants"></a>
        
          <a class="page-link" href="/archives/336/"></a>
        
          <a class="page-link" href="/post/advantages-of-link-over-copying"></a>
        
          <a class="page-link" href="/archives/353/"></a>
        
          <a class="page-link" href="/post/hangul-jaso"></a>
        
          <a class="page-link" href="/archives/375/"></a>
        
          <a class="page-link" href="/post/hangul-syllable-manipulation"></a>
        
          <a class="page-link" href="/archives/378/"></a>
        
          <a class="page-link" href="/post/selectquery"></a>
        
          <a class="page-link" href="/archives/425/"></a>
        
          <a class="page-link" href="/post/delegating-math-homework-to-computer"></a>
        
          <a class="page-link" href="/archives/420/"></a>
        
          <a class="page-link" href="/post/linux-system-in-danger"></a>
        
          <a class="page-link" href="/archives/552/"></a>
        
          <a class="page-link" href="/post/changing-order-of-operators"></a>
        
          <a class="page-link" href="/archives/555/"></a>
        
          <a class="page-link" href="/post/my-first-assembly-program"></a>
        
          <a class="page-link" href="/archives/558/"></a>
        
          <a class="page-link" href="/post/base62"></a>
        
          <a class="page-link" href="/archives/598/"></a>
        
          <a class="page-link" href="/post/bubble-sort"></a>
        
          <a class="page-link" href="/archives/597/"></a>
        
          <a class="page-link" href="/post/logn"></a>
        
          <a class="page-link" href="/archives/600/"></a>
        
          <a class="page-link" href="/post/dynamic-class-loading-in-java"></a>
        
          <a class="page-link" href="/archives/614/"></a>
        
          <a class="page-link" href="/post/longest-common-subsequence"></a>
        
          <a class="page-link" href="/archives/659/"></a>
        
          <a class="page-link" href="/post/php-timer"></a>
        
          <a class="page-link" href="/archives/683/"></a>
        
          <a class="page-link" href="/post/how-to-return-multiple-variables-in-c-cpp"></a>
        
          <a class="page-link" href="/archives/693/"></a>
        
          <a class="page-link" href="/post/command-line-based-ogg-to-mp3-converter-on-mac-os-x"></a>
        
          <a class="page-link" href="/archives/701/"></a>
        
          <a class="page-link" href="/post/determining-where-a-bash-shell-script-is-located"></a>
        
          <a class="page-link" href="/archives/894/"></a>
        
          <a class="page-link" href="/post/getting-the-value-of-pi-using-python"></a>
        
          <a class="page-link" href="/archives/911/"></a>
        
          <a class="page-link" href="/post/calculation-of-pi-using-python-with-multithreading"></a>
        
          <a class="page-link" href="/archives/1007/"></a>
        
          <a class="page-link" href="/post/grocery-store-club-card-imitation"></a>
        
          <a class="page-link" href="/archives/1179/"></a>
        
          <a class="page-link" href="/post/mounting-remote-filesystem-over-ssh"></a>
        
          <a class="page-link" href="/archives/1119/"></a>
        
          <a class="page-link" href="/post/permutation-generation"></a>
        
          <a class="page-link" href="/archives/1196/"></a>
        
          <a class="page-link" href="/post/finding-gram-matrix"></a>
        
          <a class="page-link" href="/archives/1200/"></a>
        
          <a class="page-link" href="/post/languages-of-the-year-2009"></a>
        
          <a class="page-link" href="/archives/1222/"></a>
        
          <a class="page-link" href="/post/programming-contest-4-function-calculator"></a>
        
          <a class="page-link" href="/archives/1230/"></a>
        
          <a class="page-link" href="/post/hanja-hanguel-translator"></a>
        
          <a class="page-link" href="/archives/1236/"></a>
        
          <a class="page-link" href="/post/python-ternary-operator"></a>
        
          <a class="page-link" href="/post/double-ssh-tunneling"></a>
        
          <a class="page-link" href="/archives/1327/"></a>
        
          <a class="page-link" href="/post/programmers-way-to-vote-on-doodle"></a>
        
          <a class="page-link" href="/archives/1388/"></a>
        
          <a class="page-link" href="/post/the-country-that-killed-wal-mart"></a>
        
          <a class="page-link" href="/archives/1501/"></a>
        
          <a class="page-link" href="/post/epson-nx420-no-ink-no-scanning"></a>
        
          <a class="page-link" href="/archives/1524/"></a>
        
          <a class="page-link" href="/post/visualization-of-pythons-pseudorandom-function"></a>
        
          <a class="page-link" href="/archives/1559/"></a>
        
          <a class="page-link" href="/post/reasons-why-i-dont-like-ndas"></a>
        
          <a class="page-link" href="/archives/1600/"></a>
        
          <a class="page-link" href="/post/thoughts-about-computer-science"></a>
        
          <a class="page-link" href="/archives/1627/"></a>
        
          <a class="page-link" href="/post/inconvenience-of-american-life"></a>
        
          <a class="page-link" href="/post/dreams-come-true"></a>
        
          <a class="page-link" href="/archives/1710/"></a>
        
          <a class="page-link" href="/post/is-there-any-more-software-to-come"></a>
        
          <a class="page-link" href="/archives/1729/"></a>
        
          <a class="page-link" href="/post/downloading-lecture-notes-in-batch"></a>
        
          <a class="page-link" href="/archives/1756/"></a>
        
          <a class="page-link" href="/post/impersonation"></a>
        
          <a class="page-link" href="/archives/1770/"></a>
        
          <a class="page-link" href="/post/what-you-eat-is-what-you-are"></a>
        
          <a class="page-link" href="/archives/1792/"></a>
        
          <a class="page-link" href="/post/how-better-translator-was-born"></a>
        
          <a class="page-link" href="/archives/1811/"></a>
        
          <a class="page-link" href="/post/thoughts-about-computer-science-2"></a>
        
          <a class="page-link" href="/archives/1837/"></a>
        
          <a class="page-link" href="/post/cryptography"></a>
        
          <a class="page-link" href="/archives/1856/"></a>
        
          <a class="page-link" href="/post/better-translator-tips"></a>
        
          <a class="page-link" href="/archives/1861/"></a>
        
          <a class="page-link" href="/post/bayes-theorem"></a>
        
          <a class="page-link" href="/archives/1883/"></a>
        
          <a class="page-link" href="/post/packet-corruption"></a>
        
          <a class="page-link" href="/archives/1889/"></a>
        
          <a class="page-link" href="/post/translation-sample-search"></a>
        
          <a class="page-link" href="/post/crisis-of-better-translator"></a>
        
          <a class="page-link" href="/archives/1920/"></a>
        
          <a class="page-link" href="/post/mathjax-matrix-rendering-issues-with-wordpress-markdown-plugin"></a>
        
          <a class="page-link" href="/post/goodbye-wordpress-hello-jekyll"></a>
        
          <a class="page-link" href="/post/raspberry-pi-gpio"></a>
        
          <a class="page-link" href="/post/to-move-or-not-to-move"></a>
        
          <a class="page-link" href="/post/problems-with-korean-online-banking"></a>
        
          <a class="page-link" href="/post/an-introduction-to-opencl-programming-model"></a>
        
          <a class="page-link" href="/post/salary-war"></a>
        
          <a class="page-link" href="/post/hicuda"></a>
        
          <a class="page-link" href="/post/sparse-matrix-representations"></a>
        
          <a class="page-link" href="/post/the-best-employee-benefits"></a>
        
          <a class="page-link" href="/post/penthouse"></a>
        
          <a class="page-link" href="/post/8percent"></a>
        
          <a class="page-link" href="/post/spoqa-pycon-2016-obfuscation-contest"></a>
        
          <a class="page-link" href="/post/roadtrip-in-australia-prep"></a>
        
          <a class="page-link" href="/post/roadtrip-in-australia-day1"></a>
        
          <a class="page-link" href="/post/roadtrip-in-australia-day2-1"></a>
        
          <a class="page-link" href="/post/roadtrip-in-australia-financial-settlement"></a>
        
          <a class="page-link" href="/post/honest-fund"></a>
        
          <a class="page-link" href="/post/personal-wiki"></a>
        
          <a class="page-link" href="/post/kakaopay-qrcode"></a>
        
          <a class="page-link" href="/redirects.json"></a>
        
          <a class="page-link" href="/pages/2/"></a>
        
          <a class="page-link" href="/pages/3/"></a>
        
          <a class="page-link" href="/pages/4/"></a>
        
          <a class="page-link" href="/pages/5/"></a>
        
          <a class="page-link" href="/pages/6/"></a>
        
      </div>
    </nav>
    -->

    <script>
      (function() {
        var cx = '006822314949201949413:idm5bn05que';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
            '//www.google.com/cse/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:search></gcse:search>

  </div>

</header>


    <div class="page-content">
      <div class="wrap">
      <div class="post">

  <header class="post-header">
    <h1>메모리 할당</h1>
    <p class="meta">Aug 5, 2004
     • Sumin Byeon
     • Software Engineering</p>
  </header>

  <article class="post-content">
  
  
  
  

  
  <div class="critical message">
    This article is more than ten years old and potentially contains out-dated information.<br/>
    작성한지 10년 이상 지난 게시물입니다. 최신의 정보와 맞지 않는 내용을 포함할 수도 있습니다.
  </div>
  
  
  <p>응용프로그램이 사용하는 메모리 영역은 크게 스택(stack)과 힙(heap)으로 나눌 수 있다.</p>

<p>자동변수는 스택 영역에, 그 이외의 변수(global, static, new, malloc, GlobalAlloc)는 힙 영역에 할당된다.</p>

<p>힙은 또다시 두가지로 나뉘는데, 윈도우 힙과 CRT(C Run-Time)힙이다.</p>

<p>윈도우 힙은 모든 윈도우 응용프로그램이 공유하는 큰 메모리 공간으로, 주로 큰 메모리 블록을 할당받고자 할 때 사용한다. 윈도우 힙을 할당받으려면 GlobalAlloc 함수를 사용한다.</p>

<p>CRT 힙은 윈도우 힙과는 별도로 프로그램마다 별도로 존재하는 힙이다. malloc함수나 new연산자를 이용하여 메모리를 할당받으면 이 영역에 메모리가 할당된다.
CRT 힙은 초기에 64KB의 공간을 갖게 되며, 이 공간을 다 쓰면 메모리 공간을 두배씩 늘려나간다. 일반적으로 CRT 힙을 사용하는것이 윈도우 힙을 사용하는 것 보다 속도가 빠르지만, CRT 힙 영역에 큰 공간을 할당받으려면 메모리 영역을 넓혀나가는 작업을 여러번 해야 하므로 큰 메모리 공간이 필요할 때는 윈도우 힙을 사용하는 것이 바람직하다.</p>

<p>(참고로, malloc 함수보다 new 연산자가 더 빠르게 동작한다고 한다. 실험을 한번 해봐야겠네)</p>

<p>[윈도우 힙 할당받기]</p>

<blockquote>The GlobalAlloc function allocates the specified number of bytes from the heap. Windows memory management does not provide a separate local heap and global heap.
Note  The global functions are slower than other memory management functions and do not provide as many features. Therefore, new applications should use the heap functions. However, the global functions are still used with DDE, the clipboard functions, and OLE data objects.
HGLOBAL GlobalAlloc( UINT uFlags,  SIZE_T dwBytes );
</blockquote>
<p>MSDN에는 이렇게 나와 있다.</p>
<blockquote>
  <p>GlobalAlloc 함수는 힙 영역에 특정 크기(바이트 단위)의 메모리를 할당해준다. 윈도우 메모리 관리자는 로컬 힙 영역과 글로벌 힙 영역을 나누는것을 지원하지 않는다.</p>
</blockquote>

<p>GlobalAlloc 함수는 다음과 같이 사용할 수 있다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LPSTR lpMem = (LPSTR)GlobalAlloc(GMEM_FIXED|GMEM_ZEROINIT, 1024*1024);
// ....
GlobalFree(lpMem);
</code></pre></div></div>

<p>GMEM_MOVEABLE를 설정하면 메모리 블럭이 이동 가능하도록 할당되고, <code class="highlighter-rouge">GMEM_FIXED</code>를 설정하면 고정된 메모리 블럭이 할당된다. 여기에 <code class="highlighter-rouge">GMEM_ZEROINIT</code>를 조합하면 할당된 메모리가 0으로 초기화된다.</p>

<p>이동 가능한 메모리 블럭은 메모리가 부족할 경우 언제든지 다른 곳으로 이동될 수 있다. 메모리 블럭이 다른곳으로 이동되고 나면, 메모리 블럭을 가리키고 있던 포인터도 바뀌게 된다. 따라서, GlobalAlloc 함수는 메모리의 포인터를 넘겨주지 않고, 글로벌 핸들을 넘겨준다. 이동 가능한 메모리 블럭을 사용할 때에는 GlobalLock 함수를 이용하여 잠시 고정시켜 사용해야 한다.</p>

<p>이동 가능한 메모리 블럭은 다음과 같이 할당한다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HGLOBAL hMem = GlobalAlloc(GMEM_MOVEABLE, 1024*1024);
LPSTR lpMem = (LPSTR)GlobalLock(hMem);
// ....
GlobalUnlock(hMem);
GlobalFree(hMem);
</code></pre></div></div>

<p>Visual C++ 완벽가이드 2nd Edition 을 읽고 나름대로의 언어로 정리해봤다.</p>


  </article>

  <!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style ">
<a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
<a class="addthis_button_tweet"></a>
<a class="addthis_counter addthis_pill_style"></a>
</div>
<script type="text/javascript">var addthis_config = {"data_track_addressbar":false};</script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4d8edc142ba2266a"></script>
<!-- AddThis Button END -->


  
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname = 'blog-suminb-com'; // required: replace example with your forum shortname
    
    var disqus_url = 'http://blog.suminb.com/archives/57';
    

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  
</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrap">

    <div class="footer-heading">
      <h2>Rubbish Philosopher</h2>
      <p class="site-description">This statement is false.</p>
    </div>


    <div class="footer-col-1 column">
      <ul>
        <li>Subscribe <a href="/feed.xml">via RSS</a></li>
      </ul>
    </div>

    <div class="footer-col-2 column">
      <ul>
        <li>
          <a href="https://github.com/suminb">
            <span class="icon github">
              <svg version="1.1" class="github-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill-rule="evenodd" clip-rule="evenodd" fill="#C2C2C2" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761
                c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32
                c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472
                c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037
                C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65
                c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261
                c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082
                c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129
                c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            <span class="username">suminb</span>
          </a>
        </li>
        <li>
          <a href="https://twitter.com/suminb">
            <span class="icon twitter">
              <svg version="1.1" class="twitter-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill="#C2C2C2" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27
                c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767
                c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206
                C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271
                c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469
                c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
              </svg>
            </span>
            <span class="username">suminb</span>
          </a>
        </li>
      </ul>
    </div>

    <div class="footer-col-3 column">
      <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" /></a>
      <p class="license">This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>.</p>
    </div>

  </div>

</footer>

    
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-346833-1', 'auto', {'allowLinker': true});
  ga('require', 'linker');
  ga('linker:autoLink', ['philosophical.one', 'blog.suminb.com']);
  ga('send', 'pageview');

</script>



    <script type="text/javascript"
       src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_SVG"></script>
    <!--
    NOTE: Originally, we've been using http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML
    (same MathJax.js file, but with a different configuration), which comes with a somewhat ugly font.
    So we decided to use a different configuration (TeX-AMS_SVG), which is used by StackEdit.
    -->
    <script>
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        processEscapes: true
      }
    });
    </script>
    </body>
</html>
